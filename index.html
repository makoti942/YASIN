<!doctype html>
<html lang="en" dir="auto">
    <head>
        <meta charset="UTF-8" />
        <link rel="icon" type="image/svg+xml" href="/deriv-logo.svg" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
        <meta name="theme-color" content="#00d9ff" />
        <title>Makoti Traders | Bot Builder</title>
        
        <style>
            :root { font-size: 62.5%; }

            /* 1. DARK THEME BASE */
            .blocklyMainBackground, .injectionDiv, .body.theme--light {
                background-color: #000000 !important;
                fill: #000000 !important;
            }

            /* 2. CYBER BLUE TEXT (Default) */
            .blocklyText {
                fill: #00d9ff !important;
            }

            /* 3. THE COLOR PROTECTOR: High Specificity Selectors */
            /* This targets SVG text elements by their internal color classes */
            
            /* FORCING GREEN (Wins) */
            svg .blocklyText[style*="fill: #008000"],
            svg .blocklyText[style*="fill: rgb(0, 128, 0)"],
            .db-contract-card__result--win,
            .dc-stat__value--profit {
                fill: #00ff41 !important; 
                color: #00ff41 !important;
            }

            /* FORCING RED (Losses) */
            svg .blocklyText[style*="fill: #cc0000"],
            svg .blocklyText[style*="fill: rgb(204, 0, 0)"],
            .db-contract-card__result--loss,
            .dc-stat__value--loss {
                fill: #ff444f !important;
                color: #ff444f !important;
            }

            /* 4. STOP BUTTON (Glow Red) */
            .makoti-stop-active {
                background-color: #ff444f !important;
                color: #ffffff !important;
                box-shadow: 0 0 15px #ff444f !important;
            }

            /* 5. Inputs & Menus */
            .blocklyEditableText > .blocklyFieldRect {
                fill: #1a1a1a !important;
                stroke: #00d9ff !important;
            }
            .goog-menu, .goog-menuitem {
                background-color: #0a0e17 !important;
                color: #00d9ff !important;
            }
        </style>
    </head>

    <body class="body theme theme--light">
        <div id="root"></div>
        
        <script>
            // --- MAKOTI TRADERS UI ENGINE ---
            const uiWatcher = new MutationObserver(() => {
                
                // A. THE STOP BUTTON LOGIC
                const allButtons = document.querySelectorAll('button');
                allButtons.forEach(btn => {
                    if (btn.textContent.toLowerCase().includes('stop')) {
                        btn.classList.add('makoti-stop-active');
                    } else {
                        btn.classList.remove('makoti-stop-active');
                    }
                });

                // B. THE VALUE-BASED COLOR LOGIC (The "Ultimate Fix")
                // This checks every text element for numbers and colors them properly
                const textElements = document.querySelectorAll('.blocklyText, .dc-stat__value, span');
                
                textElements.forEach(el => {
                    const content = el.textContent.trim();
                    
                    // 1. If it contains a minus sign, it's a LOSS (Red)
                    if (content.startsWith('-') || content.includes('-$')) {
                        el.style.setProperty('fill', '#ff444f', 'important');
                        el.style.setProperty('color', '#ff444f', 'important');
                    } 
                    // 2. If it's a positive number (and not a label or time), it's a WIN (Green)
                    else if (/^\+?\d/.test(content) && !content.includes(':')) {
                        // Check if it's likely a profit value
                        if (content.includes('$') || content.includes('.') || content.startsWith('+')) {
                            el.style.setProperty('fill', '#00ff41', 'important');
                            el.style.setProperty('color', '#00ff41', 'important');
                        }
                    }
                });
            });

            // Start observing the entire bot for changes
            uiWatcher.observe(document.body, { 
                childList: true, 
                subtree: true, 
                characterData: true 
            });
        </script>
    </body>
</html>
